# Documentation of Single APK Approach Configuration
<img src="https://user-images.githubusercontent.com/62053304/169209957-e59780e8-4e68-49fc-8167-a247d696d09b.jpg" width="512">
The configurations in Single APK Approach is using the combination of a single Composition and multiple Binary resource.

## Composition
Composition config is identified using an appId and is the entry point to access all the Binary configs associated with that appId.

Example of appId would be: anc, ecbis, quest, etc.

### Structure of Composition Config
There are 2 attributes to be highlighted. It is the `identifier` and `section` attributes.

These are the only attributes that developers need to specifically fill, the other attributes can be generic by using our own template and some are also automatically generated by the FHIR server.

* `identifier`

   The `identifier` attribute is a single unique value that represents an appId and will differentiate a Composition config from one another.
   
   ```json
   "identifier": {
     "use": "official",
     "value": "appId"
   }
   ```

* `section`

   The `section` attribute is multivalue that represent configurations.
   
   Each `section` contains:
   
   * `reference` to the Binary config associated with the Composition appId
   
   * `identifier` that represents a config classification name
   
   ```json
   "section": [
    {
      "title": "App configuration",
      "mode": "working",
      "focus": {
        "reference": "Binary/xxxxx",
        "identifier": {
          "value": "application"
        }
      }
    },
    {
      "title": "Login configuration",
      "mode": "working",
      "focus": {
        "reference": "Binary/xxxxx",
        "identifier": {
          "value": "login"
        }
      }
    }
   ]
   ```

## Binary

Binary config contains attributes that will be used in the app.

List of common Binary configs `classfication`:

| `classification`               | What it configures                                                              |
| :----------------------------- | :------------------------------------------------------------------------ |
| application           | Configure the app level                             |
| login                 | Configure the login page                             |
| app_feature           | Configure the available feature                             |
| pin                   | Configure the pin page                             |
| data_filters          | Configure the filters that the app will uses e.g patient register, family register                           |
| forms                 | Configure the Questionnaires that the app will uses                           |
| patient_register      | Configure the patient register page                             |
| sync                  | Configure the resource that will be synced                             |

### Structure of Binary Config

Common attributes:

| Attributes               | Description                                 |
   | :----------------------------- | :------------------------------------------ |
   | appId           | Sets the config identifier e.g anc, ecbis, quest, etc                            | 
   | classification                 | Sets the config classification name e.g application, login, sync, etc         |

#### Structure of each classification:

1. application

   | Attributes               | Description                                 | Type |
   | :----------------------------- | :------------------------------------------ | :---- |
   | theme           | Sets the theme for the app                            | String |
   | language                 | Sets the languages for the app                          | List&lt;String&gt; |
   | syncInterval           | Sets the periodic sync interval in seconds. Default 30            | Long |
   | applicationName                   | Sets the application display name                      | String |
   | appLogoIconResourceFile          | Sets the application logo thumb icon, there must be png file inside  | String       |
   | count                 | Sets the application maximum records when downloading resource                  | String      |
   
   ```json
   {
     "appId": "ecbis-saa",
     "classification": "application",
     "theme": "AppTheme",
     "languages": ["en", "sw"],
     "applicationName": "eCBIS",
     "appLogoIconResourceFile": "ic_liberia",
     "count": "100"
   }
   ```

2. login
   | Attributes               | Description                                                          | Type |
   | :----------------------------- | :------------------------------------------------------------------------ | :--- |
   | applicationName           | Sets the application display name                            | String |
   | applicationVersion                 | Set the application display version                        | String |
   | applicationVersionCode           | Set the application version code                 | Int |
   | darkMode                   | Sets the login theme to use dark mode                             | Boolean |
   | showLogo          | Sets the login logo visibility        | Boolean |
   | enablePin                 | Sets the use of pin login feature                         | Boolean |
   
   ```json
   {
     "appId": "ecbis-saa",
     "classification": "login",
     "applicationName": "eCBIS",
     "applicationVersion": "0.0.1",
     "applicationVersionCode": 1,
     "darkMode": false,
     "showLogo": true,
     "enablePin": true
   }
   ```
   
3. app_feature

   | Attributes               | Description                                                          | Type |
   | :----------------------------- | :------------------------------------------------------------------------ | :--- |
   | appFeatures           | Sets the list of features in the app                           | List&lt;FeatureConfig&gt; |
   
   FeatureConfig
   
   | Attributes               | Description                                                          | Type |
   | :----------------------------- | :------------------------------------------------------------------------ | :--- |
   | feature           | Sets the feature name                            | String |
   | active                 | Sets the feature active status                       | Boolean |
   | settings           | Sets the custom settings of this feature, when needed                 | Map&lt;String, String&gt; |
   | target                   | Sets the user that will use this feature e.g CHW, HF         | String |
   | healthModule          | Sets the health module of this feature e.g DEFAULT, ANC, RDT, PNC, CHILD, FAMILY, FAMILY PLANNING       | String |
   | useCases                 | Sets the use cases / what this feature can do e.g PATIENT_REGISTRATION, ANC_VISITS, etc | List&lt;String&gt; |
   
   ```json
   TODO
   ```

TODO:

structure of each config classification: what each attribute does (or used in-app)

how a config is interpreted, code wise
