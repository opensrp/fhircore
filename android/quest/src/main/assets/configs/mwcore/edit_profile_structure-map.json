{
  "resourceType": "StructureMap",
  "id": "patient-demographic-registration-structure-map",
  "meta": {
    "versionId": "74",
    "lastUpdated": "2022-07-14T11:27:12.015+03:00",
    "source": "#kzkErz7e4UeGz9BF"
  },
  "url": "http://fhir-dev.d-tree.org/fhir/StructureMap/PatientDemographicRegistration",
  "name": "PatientDemographicRegistration",
  "structure": [
    {
      "url": "http://hl7.org/fhir/StructureDefinition/QuestionnaireReponse",
      "mode": "source"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/Bundle",
      "mode": "target"
    }
  ],
  "group": [
    {
      "name": "PatientRegistration",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "QuestionnaireResponse",
          "mode": "source"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_bun_type",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "collection"
                }
              ]
            }
          ]
        },
        {
          "name": "r_bun_entries",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "entry"
            },
            {
              "context": "entry",
              "contextType": "variable",
              "element": "resource",
              "variable": "patient",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Patient"
                }
              ]
            }
          ],
          "dependent": [
            {
              "name": "ExtractPatient",
              "variable": [
                "src",
                "patient",
                "bundle"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractPatient",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "QuestionnaireResponse",
          "mode": "source"
        },
        {
          "name": "patient",
          "type": "Patient",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_p_id_1",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            }
          ]
        },
        {
          "name": "r_p_active",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "active",
              "transform": "copy",
              "parameter": [
                {
                  "valueBoolean": true
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item_bio",
              "condition": "(linkId = 'page-patient-personal-details')"
            }
          ],
          "rule": [
            {
              "name": "r_p_name",
              "source": [
                {
                  "context": "item_bio",
                  "element": "item",
                  "variable": "item_name",
                  "condition": "(linkId = 'patient-name')"
                }
              ],
              "target": [
                {
                  "context": "patient",
                  "contextType": "variable",
                  "element": "name",
                  "variable": "patientName",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "HumanName"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_p_required_fname",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientName",
                      "contextType": "variable",
                      "element": "given",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_name"
                        },
                        {
                          "valueString": "$this.item.where((linkId = 'required-first-name') and (answer.count() > 0)).answer.value"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_optional_fname",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientName",
                      "contextType": "variable",
                      "element": "given",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_name"
                        },
                        {
                          "valueString": "$this.item.where((linkId = 'optional-first-name') and (answer.count() > 0)).answer.value"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_lname",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientName",
                      "contextType": "variable",
                      "element": "family",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_name"
                        },
                        {
                          "valueString": "$this.item.where(linkId = 'last-name').answer.value"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_p_gender",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "patient",
                  "contextType": "variable",
                  "element": "gender",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "item_bio"
                    },
                    {
                      "valueString": "$this.item.where(linkId = 'gender').answer.value.code"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_p_dob",
              "source": [
                {
                  "context": "item_bio",
                  "element": "item",
                  "variable": "item_dob",
                  "condition": "((linkId = 'date-of-birth') and (answer.count() > 0))"
                }
              ],
              "target": [
                {
                  "context": "patient",
                  "contextType": "variable",
                  "element": "birthDate",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "item_dob"
                    },
                    {
                      "valueString": "$this.answer.value"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_age_in_days",
              "source": [
                {
                  "context": "item_bio",
                  "element": "item",
                  "variable": "age",
                  "condition": "((linkId = 'age') and (answer.count() > 0))"
                }
              ],
              "target": [
                {
                  "variable": "age_in_days",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "age"
                    },
                    {
                      "valueString": "(($this.answer.value * 365).toString() + ' days').toQuantity()"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_approx_dob",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "variable": "approximate_date_of_birth",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "today() - age_in_days"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_year_of_birth",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "variable": "year_of_birth",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "approximate_date_of_birth.toString().substring(0, 4)"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_month_and_day_of_birth",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "variable": "month_and_day_of_birth",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "src"
                                },
                                {
                                  "valueString": "today().toString().substring(5)"
                                }
                              ]
                            }
                          ],
                          "rule": [
                            {
                              "name": "r_dob_today_x_years_ago",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "patient",
                                  "contextType": "variable",
                                  "element": "birthDate",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "src"
                                    },
                                    {
                                      "valueString": "year_of_birth + '-' + month_and_day_of_birth"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item_location",
              "condition": "(linkId = 'page-patient-location-details')"
            }
          ],
          "rule": [
            {
              "name": "r_p_address",
              "source": [
                {
                  "context": "item_location",
                  "element": "item",
                  "variable": "item_address",
                  "condition": "(linkId = 'patient-address')"
                }
              ],
              "target": [
                {
                  "context": "patient",
                  "contextType": "variable",
                  "element": "address",
                  "variable": "patientAddress",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Address"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_p_add_district",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "district",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_address"
                        },
                        {
                          "valueString": "$this.item.where(linkId = 'district').answer.value.display"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_trace_catch_balaka",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "state",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_address"
                        },
                        {
                          "valueString": "$this.item.where((linkId = 'tracing-catchment-balaka') and (answer.count() > 0)).answer.value.display"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_trace_catch_machinga",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "state",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_address"
                        },
                        {
                          "valueString": "$this.item.where((linkId = 'tracing-catchment-machinga') and (answer.count() > 0)).answer.value.display"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_trace_catch_mangochi",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "state",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_address"
                        },
                        {
                          "valueString": "$this.item.where((linkId = 'tracing-catchment-mangochi') and (answer.count() > 0)).answer.value.display"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_trace_catch_phalombe",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "state",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_address"
                        },
                        {
                          "valueString": "$this.item.where((linkId = 'tracing-catchment-phalombe') and (answer.count() > 0)).answer.value.display"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_trace_catch_salima",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "state",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_address"
                        },
                        {
                          "valueString": "$this.item.where((linkId = 'tracing-catchment-salima') and (answer.count() > 0)).answer.value.display"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_state",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "text",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_address"
                        },
                        {
                          "valueString": "$this.item.where(linkId = 'physical-locator').answer.value"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_use",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "use",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "home"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_add_typ",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientAddress",
                      "contextType": "variable",
                      "element": "type",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "physical"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item_phone_detail",
              "condition": "(linkId = 'page-patient-phone-numbers')"
            }
          ],
          "rule": [
            {
              "name": "r_p_tel",
              "source": [
                {
                  "context": "item_phone_detail",
                  "element": "item",
                  "variable": "item_tele",
                  "condition": "(linkId = 'contact-information')"
                }
              ],
              "target": [
                {
                  "context": "patient",
                  "contextType": "variable",
                  "element": "telecom",
                  "variable": "patientContact",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "ContactPoint"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_p_tel_num",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientContact",
                      "contextType": "variable",
                      "element": "value",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_tele"
                        },
                        {
                          "valueString": "$this.item.where(linkId = 'first-phone-number').answer.value"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_tel_sys",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "patientContact",
                      "contextType": "variable",
                      "element": "system",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "phone"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_tel2",
                  "source": [
                    {
                      "context": "item_tele",
                      "element": "item",
                      "variable": "item_tele2",
                      "condition": "(linkId = 'second-contact-information')"
                    }
                  ],
                  "target": [
                    {
                      "context": "patient",
                      "contextType": "variable",
                      "element": "telecom",
                      "variable": "patientContact2",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "ContactPoint"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_p_tel2_num",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "patientContact2",
                          "contextType": "variable",
                          "element": "value",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "item_tele2"
                            },
                            {
                              "valueString": "$this.item.where(linkId = 'second-phone-number').answer.value"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_p_tel2_sys",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "patientContact2",
                          "contextType": "variable",
                          "element": "system",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "phone"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item_chw_assigned",
              "condition": "(linkId = 'page-chw-assigned')"
            }
          ],
          "rule": [
            {
              "name": "r_p_chw_assigned",
              "source": [
                {
                  "context": "item_chw_assigned",
                  "element": "item",
                  "variable": "item_chw",
                  "condition": "(linkId = 'chw_assigned')"
                }
              ],
              "target": [
                {
                  "context": "patient",
                  "contextType": "variable",
                  "element": "generalPractitioner",
                  "variable": "pref",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Reference"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_p_chw_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "pref",
                      "contextType": "variable",
                      "element": "reference",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "item_chw"
                        },
                        {
                          "valueString": "$this.answer.value.code"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "summary_page",
              "condition": "(linkId = 'summary-page')"
            }
          ],
          "rule": [
            {
              "name": "item",
              "source": [
                {
                  "context": "summary_page",
                  "element": "item",
                  "variable": "meta_group",
                  "condition": "(linkId = 'meta-group')"
                }
              ],
              "rule": [
                {
                  "name": "r_p_meta_newly_diagnosed_client",
                  "source": [
                    {
                      "context": "meta_group",
                      "element": "item",
                      "variable": "newly_diagnosed_client",
                      "condition": "((linkId = 'meta-newly-diagnosed-client') and (answer.count() > 0))"
                    }
                  ],
                  "target": [
                    {
                      "context": "patient",
                      "contextType": "variable",
                      "element": "meta",
                      "variable": "meta",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Meta"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_p_meta_tag_newly_diagnosed client",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "meta",
                          "contextType": "variable",
                          "element": "tag",
                          "variable": "coding",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Coding"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_p_coding_system_newly_diagnosed_client",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "system",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "newly_diagnosed_client"
                                },
                                {
                                  "valueString": "$this.answer.value.system"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_code_newly_diagnosed_client",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "code",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "newly_diagnosed_client"
                                },
                                {
                                  "valueString": "$this.answer.value.code"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_display_newly_diagnosed_client",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "newly_diagnosed_client"
                                },
                                {
                                  "valueString": "$this.answer.value.display"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_create_ndc_care_plan",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "CreateCarePlan",
                          "variable": [
                            "patient",
                            "bundle"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_meta_client_already_on_art",
                  "source": [
                    {
                      "context": "meta_group",
                      "element": "item",
                      "variable": "client_already_on_art",
                      "condition": "((linkId = 'meta-client-already-on-art') and (answer.count() > 0))"
                    }
                  ],
                  "target": [
                    {
                      "context": "patient",
                      "contextType": "variable",
                      "element": "meta",
                      "variable": "meta",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Meta"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_p_meta_tag_client_already_on_art",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "meta",
                          "contextType": "variable",
                          "element": "tag",
                          "variable": "coding",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Coding"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_p_coding_system_client_already_on_art",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "system",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "client_already_on_art"
                                },
                                {
                                  "valueString": "$this.answer.value.system"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_code_client_already_on_art",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "code",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "client_already_on_art"
                                },
                                {
                                  "valueString": "$this.answer.value.code"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_display_client_already_on_art",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "client_already_on_art"
                                },
                                {
                                  "valueString": "$this.answer.value.display"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_create_caart_care_plan",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "CreateCarePlan",
                          "variable": [
                            "patient",
                            "bundle"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_meta_exposed_infant",
                  "source": [
                    {
                      "context": "meta_group",
                      "element": "item",
                      "variable": "exposed_infant",
                      "condition": "((linkId = 'meta-exposed-infant') and (answer.count() > 0))"
                    }
                  ],
                  "target": [
                    {
                      "context": "patient",
                      "contextType": "variable",
                      "element": "meta",
                      "variable": "meta",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Meta"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_p_meta_tag_exposed_infant",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "meta",
                          "contextType": "variable",
                          "element": "tag",
                          "variable": "coding",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Coding"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_p_coding_system_exposed_infant",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "system",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "exposed_infant"
                                },
                                {
                                  "valueString": "$this.answer.value.system"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_code_exposed_infant",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "code",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "exposed_infant"
                                },
                                {
                                  "valueString": "$this.answer.value.code"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_display_exposed_infant",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "exposed_infant"
                                },
                                {
                                  "valueString": "$this.answer.value.display"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_create_ei_care_plan",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "CreateCarePlan",
                          "variable": [
                            "patient",
                            "bundle"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_p_meta_community_positive",
                  "source": [
                    {
                      "context": "meta_group",
                      "element": "item",
                      "variable": "community_positive",
                      "condition": "((linkId = 'meta-community-positive') and (answer.count() > 0))"
                    }
                  ],
                  "target": [
                    {
                      "context": "patient",
                      "contextType": "variable",
                      "element": "meta",
                      "variable": "meta",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Meta"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_p_meta_coding_community_positive",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "meta",
                          "contextType": "variable",
                          "element": "tag",
                          "variable": "coding",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Coding"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_p_coding_system_community_positive",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "system",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "community_positive"
                                },
                                {
                                  "valueString": "$this.answer.value.system"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_code_community_positive",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "code",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "community_positive"
                                },
                                {
                                  "valueString": "$this.answer.value.code"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_p_coding_display_community_positive",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "community_positive"
                                },
                                {
                                  "valueString": "$this.answer.value.display"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "CreateCarePlan",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_cp",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "entry"
            },
            {
              "context": "entry",
              "contextType": "variable",
              "element": "resource",
              "variable": "carePlan",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_cp_data",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "id",
                  "transform": "uuid"
                },
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "status",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "active"
                    }
                  ]
                },
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "intent",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "plan"
                    }
                  ]
                },
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "created",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "now()"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_cp_id",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "identifier",
                  "variable": "carePlanIdentifier",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Identifier"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_cp_identifier_value",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanIdentifier",
                      "contextType": "variable",
                      "element": "value",
                      "transform": "uuid"
                    }
                  ]
                },
                {
                  "name": "r_cp_identifier_use",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanIdentifier",
                      "contextType": "variable",
                      "element": "use",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "official"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_cp_title",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "subject",
                  "variable": "carePlanSubject",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Reference"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_cp_subject_reference",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanSubject",
                      "contextType": "variable",
                      "element": "reference",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "'Patient/' + $this.id"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_cp_subject_display",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanSubject",
                      "contextType": "variable",
                      "element": "display",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "$this.name.given + ' ' + $this.name.family"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_cp_period",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "period",
                  "variable": "carePlanPeriod",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Period"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_cp_period_start",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanPeriod",
                      "contextType": "variable",
                      "element": "start",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "now()"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_cp_period_end",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanPeriod",
                      "contextType": "variable",
                      "element": "end",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "now() + ('14 days').toQuantity()"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_cp_author",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "author",
                  "variable": "carePlanAuthor",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Reference"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_cp_author_reference",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanAuthor",
                      "contextType": "variable",
                      "element": "reference",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_cp_author_display",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "carePlanAuthor",
                      "contextType": "variable",
                      "element": "display",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Test CHW"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_cp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "title",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "iif($this.meta.tag.where(code = 'newly-diagnosed-client').exists(), 'Newly Diagnosed Client First Visit')"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_meta_ndc",
              "source": [
                {
                  "context": "src",
                  "element": "meta",
                  "variable": "meta"
                }
              ],
              "rule": [
                {
                  "name": "r_tag_meta_ndc",
                  "source": [
                    {
                      "context": "meta",
                      "element": "tag",
                      "variable": "tag",
                      "condition": "(code = 'newly-diagnosed-client')"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_add_act_ndc",
                      "source": [
                        {
                          "context": "tag"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "AddNewlyDiagnosedClientActivities",
                          "variable": [
                            "src",
                            "carePlan",
                            "bundle"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ei_cp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "title",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "iif($this.meta.tag.where(code = 'exposed-infant').exists(), 'Exposed Infant First Visit')"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_meta_ei",
              "source": [
                {
                  "context": "src",
                  "element": "meta",
                  "variable": "meta"
                }
              ],
              "rule": [
                {
                  "name": "r_tag_meta_ei",
                  "source": [
                    {
                      "context": "meta",
                      "element": "tag",
                      "variable": "tag",
                      "condition": "(code = 'exposed-infant')"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_add_act_ei",
                      "source": [
                        {
                          "context": "tag"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "AddExposedInfantActivities",
                          "variable": [
                            "src",
                            "carePlan",
                            "bundle"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_caart_cp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "carePlan",
                  "contextType": "variable",
                  "element": "title",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "iif($this.meta.tag.where(code = 'client-already-on-art').exists(), 'ART Client Visit')"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_meta_ei",
              "source": [
                {
                  "context": "src",
                  "element": "meta",
                  "variable": "meta"
                }
              ],
              "rule": [
                {
                  "name": "r_tag_meta_ei",
                  "source": [
                    {
                      "context": "meta",
                      "element": "tag",
                      "variable": "tag",
                      "condition": "(code = 'client-already-on-art')"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_add_act_ei",
                      "source": [
                        {
                          "context": "tag"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "AddClientAlreadyOnARTActivities",
                          "variable": [
                            "src",
                            "carePlan",
                            "bundle"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddNewlyDiagnosedClientActivities",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_act_add_acts",
          "source": [
            {
              "context": "src"
            }
          ],
          "dependent": [
            {
              "name": "AddPatientTBCovidActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddPatientDemographicUpdatesActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddPatientGuardianUpdatesActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientVitalsActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientIndexCaseTestingActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientWelcomeServiceActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientUniqueIdentifierAndHIVTestActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientClinicalStageAndCD4Activity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientTBHistoryAndRegimenAndNextAppointmentActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientVitalsActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_vitals_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_vitals_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_vitals_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Vitals"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_vitals_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_vitals_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "client-vitals"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_vitals_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Vitals"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_vitals_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Vitals"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_vitals_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_vitals_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_vitals_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_vitals_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_vitals_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_vitals_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_vitals_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_vitals_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientVitalsTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_vitals_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_vitals_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_vitals_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientVitalsTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_vitals_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Vitals"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_vitals_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_vitals_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_vitals_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_vitals_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_vitals_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_vitals_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_vitals_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_vitals_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_vitals_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinic_reg_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_patient_birth_date",
              "source": [
                {
                  "context": "src",
                  "element": "birthDate",
                  "variable": "birthDate"
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_patient_gender",
                  "source": [
                    {
                      "context": "src",
                      "element": "gender",
                      "variable": "gender"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_date_ranges",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "variable": "date_6_months_ago",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "(today() - ((6 * 30).toString() + ' days').toQuantity())"
                            }
                          ]
                        },
                        {
                          "variable": "date_5_years_ago",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "(today() - ((5 * 365).toString() + ' days').toQuantity())"
                            }
                          ]
                        },
                        {
                          "variable": "date_15_years_ago",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "(today() - ((15 * 365).toString() + ' days').toQuantity())"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_gender_male",
                          "source": [
                            {
                              "context": "src",
                              "condition": "(gender = 'male')"
                            }
                          ],
                          "rule": [
                            {
                              "name": "r_vitals_male_0_to_6_months",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_6_months_ago"
                                    },
                                    {
                                      "valueString": "iif(birthDate >= $this, 'Questionnaire/art-client-vitals-male-0-to-6-months')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_vitals_6_months_to_5_years",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_5_years_ago"
                                    },
                                    {
                                      "valueString": "iif((birthDate >= $this) and (birthDate < date_6_months_ago), 'Questionnaire/art-client-vitals-6-months-to-5-years')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_vitals_5_to_15_years",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_15_years_ago"
                                    },
                                    {
                                      "valueString": "iif((birthDate >= $this) and (birthDate < date_5_years_ago), 'Questionnaire/art-client-vitals-5-to-15-years')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_vitals_male_15_years_plus",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_15_years_ago"
                                    },
                                    {
                                      "valueString": "iif(birthDate < $this, 'Questionnaire/art-client-vitals-male-15-years-plus')"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_ndc_gender_female",
                          "source": [
                            {
                              "context": "src",
                              "condition": "(gender = 'female')"
                            }
                          ],
                          "rule": [
                            {
                              "name": "r_vitals_female_0_to_6_months",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_6_months_ago"
                                    },
                                    {
                                      "valueString": "iif(birthDate >= $this, 'Questionnaire/art-client-vitals-female-0-to-6-months')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_vitals_6_months_to_5_years",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_5_years_ago"
                                    },
                                    {
                                      "valueString": "iif((birthDate >= $this) and (birthDate < date_6_months_ago), 'Questionnaire/art-client-vitals-6-months-to-5-years')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_vitals_5_to_15_years",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_15_years_ago"
                                    },
                                    {
                                      "valueString": "iif((birthDate >= $this) and (birthDate < date_5_years_ago), 'Questionnaire/art-client-vitals-5-to-15-years')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_vitals_female_15_years_plus",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_15_years_ago"
                                    },
                                    {
                                      "valueString": "iif(birthDate < $this, 'Questionnaire/art-client-vitals-female-15-years-plus')"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinic_reg_task_reason_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Vitals"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_vitals_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_vitals_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_vitals_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_vitals_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_vitals_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_vitals_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientIndexCaseTestingActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_index_case_testing_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_index_case_testing_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_index_case_testing_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Index Case Testing"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_index_case_testing_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_index_case_testing_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "client-index-case-testing-screening"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_index_case_testing_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Index Case Testing"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_index_case_testing_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Index Case Testing"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_index_case_testing_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_index_case_testing_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_index_case_testing_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_index_case_testing_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_index_case_testing_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_index_case_testing_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_index_case_testing_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_index_case_testing_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientIndexCaseTestingTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_index_case_testing_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_index_case_testing_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_index_case_testing_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientIndexCaseTestingTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_index_case_testing_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Index Case Testing"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_index_case_testing_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_index_case_testing_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_index_case_testing_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_index_case_testing_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_index_case_testing_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_index_case_testing_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_index_case_testing_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_index_case_testing_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_index_case_testing_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_index_case_testing_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_index_case_testing_task_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/art-client-index-case-testing"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_index_case_testing_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Index Case Testing"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_index_case_testing_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_index_case_testing_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_index_case_testing_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_index_case_testing_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_index_case_testing_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_index_case_testing_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientWelcomeServiceActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_welcome_service_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_welcome_service_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_welcome_service_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Welcome Service"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_welcome_service_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_welcome_service_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "client-welcome-service"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_welcome_service_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Welcome Service"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_welcome_service_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Welcome Service"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_welcome_service_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_welcome_service_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_welcome_service_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_welcome_service_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_welcome_service_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_welcome_service_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_welcome_service_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_welcome_service_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientWelcomeServiceTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_welcome_service_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_welcome_service_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_welcome_service_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientWelcomeServiceTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_welcome_service_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Welcome Service"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_welcome_service_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_welcome_service_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_welcome_service_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_welcome_service_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_welcome_service_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_welcome_service_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_welcome_service_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_welcome_service_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_welcome_service_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_welcome_service_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_welcome_service_appn_meta",
              "source": [
                {
                  "context": "src",
                  "element": "meta",
                  "variable": "meta"
                }
              ],
              "rule": [
                {
                  "name": "r_welcome_service_tag_ndc",
                  "source": [
                    {
                      "context": "meta",
                      "element": "tag",
                      "variable": "tag",
                      "condition": "(code = 'newly-diagnosed-client')"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_welcome_service_task_reason_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Questionnaire/art-client-welcome-service"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_welcome_service_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Welcome Service"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_welcome_service_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_welcome_service_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_welcome_service_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_welcome_service_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_welcome_service_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_welcome_service_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientUniqueIdentifierAndHIVTestActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_unique_id_and_hiv_test_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_unique_id_and_hiv_test_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_unique_id_and_hiv_test_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "ART/HTS Number & HIV Test"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_unique_id_and_hiv_test_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "client-unique-identifier-and-hiv-test"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_unique_id_and_hiv_test_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "ART/HTS Number & HIV Test"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "ART/HTS Number & HIV Test"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_unique_id_and_hiv_test_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_unique_id_and_hiv_test_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_unique_id_and_hiv_test_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_unique_id_and_hiv_test_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientUniqueIdentifierAndHIVTestTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_unique_id_and_hiv_test_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_unique_id_and_hiv_test_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientUniqueIdentifierAndHIVTestTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_unique_id_and_hiv_test_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ART/HTS Number & HIV Test"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_unique_id_and_hiv_test_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_unique_id_and_hiv_test_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_unique_id_and_hiv_test_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_unique_id_and_hiv_test_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/art-client-identifier-and-hiv-test"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "ART/HTS Number & HIV Test"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_unique_id_and_hiv_test_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_unique_id_and_hiv_test_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_unique_id_and_hiv_test_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientClinicalStageAndCD4Activity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_clinical_stage_and_cd4_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinical_stage_and_cd4_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_clinical_stage_and_cd4_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Clinical Stage and CD4"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinical_stage_and_cd4_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "art-client-clinical-stage-and-cd4"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_clinical_stage_and_cd4_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Clinical Stage and CD4"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Clinical Stage and CD4"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinical_stage_and_cd4_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinical_stage_and_cd4_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinical_stage_and_cd4_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_clinical_stage_and_cd4_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientClinicalStageAndCD4Task",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinical_stage_and_cd4_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinical_stage_and_cd4_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientClinicalStageAndCD4Task",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_clinical_stage_and_cd4_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Clinical Stage and CD4"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinical_stage_and_cd4_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinical_stage_and_cd4_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinical_stage_and_cd4_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinical_stage_and_cd4_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/art-client-clinical-stage-and-cd4"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Clinical Stage and CD4"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinical_stage_and_cd4_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinical_stage_and_cd4_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinical_stage_and_cd4_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientTBHistoryAndRegimenAndNextAppointmentActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "TB History, Regimen and Next Appointment"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "client-tb-history-regimen-and-next-appointment"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "TB History, Regimen and Next Appointment"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "TB History, Regimen and Next Appointment"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_tb_hist_reg_and_next_appn_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientTBHistoryAndRegimenAndNextAppointmentTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_hist_reg_and_next_appn_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientTBHistoryAndRegimenAndNextAppointmentTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "TB History, Regimen and Next Appointment"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_tb_hist_reg_and_next_appn_meta",
              "source": [
                {
                  "context": "src",
                  "element": "meta",
                  "variable": "meta"
                }
              ],
              "rule": [
                {
                  "name": "r_tb_hist_reg_and_next_appn_tag_ndc",
                  "source": [
                    {
                      "context": "meta",
                      "element": "tag",
                      "variable": "tag",
                      "condition": "(code = 'newly-diagnosed-client')"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_hist_reg_and_next_appn_task_reason_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Questionnaire/art-client-tb-history-regimen-and-next-appointment-icac"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_tb_hist_reg_and_next_appn_tag_ndc",
                  "source": [
                    {
                      "context": "meta",
                      "element": "tag",
                      "variable": "tag",
                      "condition": "(code = 'client-already-on-art')"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_caart_tb_hist_reg_and_next_appn_task_reason_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Questionnaire/art-client-tb-history-regimen-and-next-appointment-routine"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "TB History, Regimen and Next Appointment"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_hist_reg_and_next_appn_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_hist_reg_and_next_appn_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddExposedInfantActivities",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ei_act_extraction",
          "source": [
            {
              "context": "src"
            }
          ],
          "dependent": [
            {
              "name": "AddPatientTBCovidActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddPatientDemographicUpdatesActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddPatientGuardianUpdatesActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddExposedInfantVitalsActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddExposedInfantClinicalRegistrationActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddExposedInfantMilestoneHIVTestActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddExposedInfantCounsellingActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddExposedInfantMedicineAndNextAppointmentActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddExposedInfantVitalsActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_act_vitals",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_act_det_vitals",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ei_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Vitals"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ei_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ei_cp_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "exposed-infant-vitals"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_cp_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Vitals"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_act_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Vitals"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ei_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ei_act_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_act_perf_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ei_act_det_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ei_act_scheduled_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_act_scheduled_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ei_task_vitals",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "entry"
                    },
                    {
                      "context": "entry",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "task",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ext_ei_vitals",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ExtractExposedInfantVitalsTask",
                          "variable": [
                            "src",
                            "carePlan",
                            "task"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_act_outcome_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activity",
                          "contextType": "variable",
                          "element": "outcomeReference",
                          "variable": "activityOutcomeRef",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Reference"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ei_act_out_ref_ref",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "reference",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "'Task/' + $this.id"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_ei_act_out_ref_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "$this.description"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractExposedInfantVitalsTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ei_task_vitals_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Vitals"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ei_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ei_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ei_task_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ei_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ei_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ei_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ei_clinic_reg_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_patient_birth_date",
              "source": [
                {
                  "context": "src",
                  "element": "birthDate",
                  "variable": "birthDate"
                }
              ],
              "rule": [
                {
                  "name": "r_ei_patient_gender",
                  "source": [
                    {
                      "context": "src",
                      "element": "gender",
                      "variable": "gender"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ei_date_ranges",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "variable": "date_6_months_ago",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "(today() - ((6 * 30).toString() + ' days').toQuantity())"
                            }
                          ]
                        },
                        {
                          "variable": "date_3_years_ago",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "(today() - ((3 * 365).toString() + ' days').toQuantity())"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ei_gender_male",
                          "source": [
                            {
                              "context": "src",
                              "condition": "(gender = 'male')"
                            }
                          ],
                          "rule": [
                            {
                              "name": "r_ei_vitals_male_0_to_6_months",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_6_months_ago"
                                    },
                                    {
                                      "valueString": "iif(birthDate >= $this, 'Questionnaire/exposed-infant-vitals-male-0-to-6-months')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_ei_vitals_male_6_months_to_3_years",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_3_years_ago"
                                    },
                                    {
                                      "valueString": "iif((birthDate >= $this) and (birthDate < date_6_months_ago), 'Questionnaire/exposed-infant-vitals-male-6-months-to-3-years')"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_ei_gender_female",
                          "source": [
                            {
                              "context": "src",
                              "condition": "(gender = 'female')"
                            }
                          ],
                          "rule": [
                            {
                              "name": "r_ei_vitals_female_0_to_6_months",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_6_months_ago"
                                    },
                                    {
                                      "valueString": "iif(birthDate >= $this, 'Questionnaire/exposed-infant-vitals-female-0-to-6-months')"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "r_ei_vitals_female_6_months_to_3_years",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "target": [
                                {
                                  "context": "taskReasonRef",
                                  "contextType": "variable",
                                  "element": "reference",
                                  "transform": "evaluate",
                                  "parameter": [
                                    {
                                      "valueId": "date_3_years_ago"
                                    },
                                    {
                                      "valueString": "iif((birthDate >= $this) and (birthDate < date_6_months_ago), 'Questionnaire/exposed-infant-vitals-female-6-months-to-3-years')"
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_clinic_reg_task_reason_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Vitals"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ei_task_reqstr_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_task_reqstr_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ei_task_reqstr_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ei_task_owner_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_task_owner_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ei_task_owner_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddExposedInfantClinicalRegistrationActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_c_p_act_clinic_reg",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_c_p_act_det_clinic_reg",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_act_det_clinic_reg_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Clinical Registration"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_det_code_clinic_reg",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_det_cc_code_clinic_reg",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "exposed-infant-clinical-registration"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_cp_cod_disp_clinic_reg",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Clinical Registration"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_det_cc_txt_clinic_reg",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Clinical Registration"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_clinic_reg_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "performer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_clinic_reg_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_clinic_reg_perf_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_clinic_reg_sched_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_clinic_reg_sched_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_clinic_reg_sched_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_bun_entries_clinic_reg",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "entry"
                    },
                    {
                      "context": "entry",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "task",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ext_clinic_reg",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ExtractExposedInfantClinicalRegistrationTask",
                          "variable": [
                            "src",
                            "carePlan",
                            "task"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_clinic_reg_out_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activity",
                          "contextType": "variable",
                          "element": "outcomeReference",
                          "variable": "activityOutcomeRef",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Reference"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_act_clinic_reg_out_ref_ref",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "reference",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "'Task/' + $this.id"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_act_clinic_reg_out_ref_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "$this.description"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractExposedInfantClinicalRegistrationTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_clinic_reg_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Clinical Registration"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "r_clinic_reg_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_clinic_reg_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_clinic_reg_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_clinic_reg_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "taskExecutionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_clinic_reg_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_clinic_reg_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_clinic_reg_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_clinic_reg_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_clinic_reg_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_clinic_reg_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_clinic_reg_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/exposed-infant-clinical-registration"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_clinic_reg_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Clinical Registration"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_clinic_reg_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_clinic_reg_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_clinic_reg_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_clinic_reg_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_clinic_reg_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_clinic_reg_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddExposedInfantMilestoneHIVTestActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ei_patient_birth_date",
          "source": [
            {
              "context": "src",
              "element": "birthDate",
              "variable": "birthDate"
            }
          ],
          "rule": [
            {
              "name": "r_ei_date_ranges",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "variable": "date_4_weeks_ago",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "(today() - ((4 * 7).toString() + ' days').toQuantity())"
                    }
                  ]
                },
                {
                  "variable": "date_8_weeks_ago",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "(today() - ((8 * 7).toString() + ' days').toQuantity())"
                    }
                  ]
                },
                {
                  "variable": "date_50_weeks_ago",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "(today() - ((50 * 7).toString() + ' days').toQuantity())"
                    }
                  ]
                },
                {
                  "variable": "date_54_weeks_ago",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "(today() - ((54 * 7).toString() + ' days').toQuantity())"
                    }
                  ]
                },
                {
                  "variable": "date_2_years_ago",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "(today() - ((2 * 365).toString() + ' days').toQuantity())"
                    }
                  ]
                },
                {
                  "variable": "date_3_years_ago",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "(today() - ((3 * 365).toString() + ' days').toQuantity())"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ei_add_act_mile_hiv_test",
                  "source": [
                    {
                      "context": "src",
                      "condition": "(((birthDate >= date_8_weeks_ago) and (birthDate <= date_4_weeks_ago)) or ((birthDate >= date_54_weeks_ago) and (birthDate <= date_50_weeks_ago)) or ((birthDate >= date_3_years_ago) and (birthDate <= date_2_years_ago)))"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "IncludeExposedInfantMilestoneHIVTestActivity",
                      "variable": [
                        "src",
                        "carePlan",
                        "bundle"
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "IncludeExposedInfantMilestoneHIVTestActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_c_p_act_mile_hiv_test",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_c_p_act_det_mile_hiv_test",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_act_det_mile_hiv_test_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Milestone HIV Test"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_det_code_mile_hiv_test",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_cp_cc_cod_mile_hiv_test",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "exposed-infant-milestone-hiv-test"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_cp_cod_disp_mile_hiv_test",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Milestone HIV Test"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_cp_cc_txt_mile_hiv_test",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Milestone HIV Test"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_mile_hiv_test_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "performer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_mile_hiv_test_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_mile_hiv_test_perf_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_mile_hiv_test_sched_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_mile_hiv_test_sched_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_mile_hiv_test_sched_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_bun_entries_mile_hiv_test",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "entry"
                    },
                    {
                      "context": "entry",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "task",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ext_mile_hiv_test",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ExtractExposedInfantMilestoneHIVTestTask",
                          "variable": [
                            "src",
                            "carePlan",
                            "task"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_mile_hiv_test_out_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activity",
                          "contextType": "variable",
                          "element": "outcomeReference",
                          "variable": "activityOutcomeRef",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Reference"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_act_mile_hiv_test_out_ref_ref",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "reference",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "'Task/' + $this.id"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_act_mile_hiv_test_out_ref_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "$this.description"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractExposedInfantMilestoneHIVTestTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_mile_hiv_test_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Milestone HIV Test"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "r_mile_hiv_test_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_mile_hiv_test_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_mile_hiv_test_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_mile_hiv_test_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "taskExecutionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_mile_hiv_test_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_mile_hiv_test_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_mile_hiv_test_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_mile_hiv_test_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_mile_hiv_test_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_mile_hiv_test_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_mile_hiv_test_task_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/exposed-infant-milestone-hiv-test"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_mile_hiv_test_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Milestone HIV Test"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_mile_hiv_test_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_mile_hiv_test_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_mile_hiv_test_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_mile_hiv_test_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_mile_hiv_test_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_mile_hiv_test_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddExposedInfantCounsellingActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_c_p_act_couns",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_c_p_act_det_couns",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_act_det_couns_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Counselling"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_det_code_couns",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_det_cc_code_couns",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "exposed-infant-counselling"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_cp_cod_disp_couns",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Counselling"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_det_cc_txt_couns",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Counselling"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_couns_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "performer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_couns_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_couns_perf_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_couns_sched_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_couns_sched_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_couns_sched_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_bun_entries_couns",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "entry"
                    },
                    {
                      "context": "entry",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "task",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ext_couns",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ExtractExposedInfantCounsellingTask",
                          "variable": [
                            "src",
                            "carePlan",
                            "task"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_couns_out_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activity",
                          "contextType": "variable",
                          "element": "outcomeReference",
                          "variable": "activityOutcomeRef",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Reference"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_act_couns_out_ref_ref",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "reference",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "'Task/' + $this.id"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "rule_act_couns_out_ref_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "$this.description"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractExposedInfantCounsellingTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_couns_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Counselling"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "r_couns_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_couns_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_couns_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_couns_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "taskExecutionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_couns_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_couns_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_couns_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_couns_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_couns_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ei_couns_clinic_reg_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ei_couns_patient_birth_date",
              "source": [
                {
                  "context": "src",
                  "element": "birthDate",
                  "variable": "birthDate"
                }
              ],
              "rule": [
                {
                  "name": "r_ei_couns_date_ranges",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "variable": "date_6_weeks_ago",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "(today() - ((6 * 7).toString() + ' days').toQuantity())"
                        }
                      ]
                    },
                    {
                      "variable": "date_6_months_ago",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "(today() - ((6 * 30).toString() + ' days').toQuantity())"
                        }
                      ]
                    },
                    {
                      "variable": "date_18_months_ago",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "(today() - ((18 * 30).toString() + ' days').toQuantity())"
                        }
                      ]
                    },
                    {
                      "variable": "date_24_months_ago",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "src"
                        },
                        {
                          "valueString": "(today() - ((24 * 30).toString() + ' days').toQuantity())"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ei_couns_0_to_6_weeks",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "date_6_weeks_ago"
                            },
                            {
                              "valueString": "iif(birthDate >= $this, 'Questionnaire/exposed-infant-counselling-0-to-6-weeks')"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_couns_6_weeks_to_6_months",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "date_6_months_ago"
                            },
                            {
                              "valueString": "iif((birthDate >= $this) and (birthDate < date_6_weeks_ago), 'Questionnaire/exposed-infant-counselling-6-weeks-to-6-months')"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_couns_6_to_18_months",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "date_18_months_ago"
                            },
                            {
                              "valueString": "iif((birthDate >= $this) and (birthDate < date_6_months_ago), 'Questionnaire/exposed-infant-counselling-6-to-18-months')"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ei_couns_18_to_24_months",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "taskReasonRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "date_24_months_ago"
                            },
                            {
                              "valueString": "iif((birthDate >= $this) and (birthDate < date_18_months_ago), 'Questionnaire/exposed-infant-counselling-18-months-to-24-months')"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ei_couns_reg_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Counselling"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_couns_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_couns_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_couns_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_couns_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_couns_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_couns_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddExposedInfantMedicineAndNextAppointmentActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_c_p_act_med_and_next_app",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_c_p_act_det_med_and_next_app",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_act_det_med_and_next_app_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Medicine And Next Appointment"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_det_code_med_and_next_app",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_det_cc_code_med_and_next_app",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "exposed-infant-medicine-and-next-appointment"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_cp_cod_disp_med_and_next_app",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Medicine And Next Appointment"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_det_cc_txt_med_and_next_app",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Medicine And Next Appointment"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_med_and_next_app_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "performer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_med_and_next_app_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_med_and_next_app_perf_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_med_and_next_app_sched_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_med_and_next_app_sched_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_med_and_next_app_sched_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_bun_entries_med_and_next_app",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "entry"
                    },
                    {
                      "context": "entry",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "task",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ext_med_and_next_app",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ExtractExposedInfantMedicineAndNextAppointmentTask",
                          "variable": [
                            "src",
                            "carePlan",
                            "task"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_med_and_next_app_out_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activity",
                          "contextType": "variable",
                          "element": "outcomeReference",
                          "variable": "activityOutcomeRef",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Reference"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_act_med_and_next_app_out_ref_ref",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "reference",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "'Task/' + $this.id"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_act_med_and_next_app_out_ref_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "$this.description"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractExposedInfantMedicineAndNextAppointmentTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_med_and_next_app_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Medicine And Next Appointment"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "r_med_and_next_app_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_med_and_next_app_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_med_and_next_app_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_med_and_next_app_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "taskExecutionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_med_and_next_app_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_med_and_next_app_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_med_and_next_app_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_med_and_next_app_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_med_and_next_app_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_med_and_next_app_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_med_and_next_app_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/exposed-infant-medicine-and-next-appointment"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_med_and_next_app_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Medicine And Next Appointment"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_med_and_next_app_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_med_and_next_app_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_med_and_next_app_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_med_and_next_app_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_med_and_next_app_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_med_and_next_app_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientAlreadyOnARTActivities",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_caart_add_acts",
          "source": [
            {
              "context": "src"
            }
          ],
          "dependent": [
            {
              "name": "AddPatientTBCovidActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddPatientDemographicUpdatesActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddPatientGuardianUpdatesActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientVitalsActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientWomensHealthScreeningActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientClinicalRegistrationActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            },
            {
              "name": "AddClientTBHistoryAndRegimenAndNextAppointmentActivity",
              "variable": [
                "src",
                "carePlan",
                "bundle"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientWomensHealthScreeningActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_client_womens_health_screen_get_gender",
          "source": [
            {
              "context": "src",
              "element": "gender",
              "variable": "gender"
            }
          ],
          "rule": [
            {
              "name": "r_client_womens_health_screen_confirm_gender",
              "source": [
                {
                  "context": "src",
                  "condition": "(gender = 'female')"
                }
              ],
              "rule": [
                {
                  "name": "r_client_womens_health_screen_get_birth_date",
                  "source": [
                    {
                      "context": "src",
                      "element": "birthDate",
                      "variable": "birthDate"
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_client_womens_health_screen_get_calc_date_9_years_ago",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "variable": "date_9_years_ago",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "(today() - ((9 * 365).toString() + ' days').toQuantity())"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_client_womens_health_screen_perf_compare",
                          "source": [
                            {
                              "context": "src",
                              "condition": "(birthDate < date_9_years_ago)"
                            }
                          ],
                          "rule": [
                            {
                              "name": "r_client_add_act_womens_health_screen",
                              "source": [
                                {
                                  "context": "src"
                                }
                              ],
                              "dependent": [
                                {
                                  "name": "IncludeClientWomensHealthScreeningActivity",
                                  "variable": [
                                    "src",
                                    "carePlan",
                                    "bundle"
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "IncludeClientWomensHealthScreeningActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_womens_health_screen_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_womens_health_screen_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_womens_health_screen_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Women's Health Screening"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_womens_health_screen_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_womens_health_screen_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "client-womens-health-screening"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_womens_health_screen_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Women's Health Screening"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_womens_health_screen_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Women's Health Screening"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_womens_health_screen_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_womens_health_screen_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_womens_health_screen_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_womens_health_screen_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_womens_health_screen_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_womens_health_screen_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_womens_health_screen_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_womens_health_screen_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientWomensHealthScreeningTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_womens_health_screen_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_womens_health_screen_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_womens_health_screen_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientWomensHealthScreeningTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_womens_health_screen_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Women's Health Screening"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_womens_health_screen_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_womens_health_screen_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_womens_health_screen_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_womens_health_screen_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_womens_health_screen_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_womens_health_screen_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_womens_health_screen_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_womens_health_screen_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_womens_health_screen_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_art_womens_health_screen_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_art_womens_health_screen",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/art-client-womens-health-screening-female-9-years-plus"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_art_womens_health_screen_reg_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "women's Health Screening"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_womens_health_screen_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_womens_health_screen_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_womens_health_screen_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_womens_health_screen_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_womens_health_screen_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_womens_health_screen_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddClientClinicalRegistrationActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_clinic_reg_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinic_reg_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_clinic_reg_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Clinical Registration"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinic_reg_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinic_reg_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "art-client-clinical-registration"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_clinic_reg_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Clinical Registration"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinic_reg_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Clinical Registration"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinic_reg_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinic_reg_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinic_reg_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinic_reg_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinic_reg_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinic_reg_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinic_reg_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_clinic_reg_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractClientClinicalRegistrationTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_clinic_reg_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_clinic_reg_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_clinic_reg_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractClientClinicalRegistrationTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_clinic_reg_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Clinical Registration"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinic_reg_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinic_reg_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_clinic_reg_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinic_reg_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinic_reg_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinic_reg_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinic_reg_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinic_reg_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinic_reg_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinic_reg_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinic_reg_task_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/art-client-clinical-registration"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinic_reg_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Clinical Registration"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinic_reg_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinic_reg_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinic_reg_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_clinic_reg_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_clinic_reg_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_clinic_reg_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddPatientGuardianUpdatesActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_c_p_act_guard_updates",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_c_p_act_det_guard_updates",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_act_det_guard_updates_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Guardian Updates"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_det_code_guard_updates",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_cp_cc_cod_guard_updates",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "patient-guardian-updates"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_cp_cod_disp_guard_updates",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Guardian Updates"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_cp_cc_txt_guard_updates",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Guardian Updates"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_guard_updates_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "performer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_guard_updates_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_guard_updates_perf_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_guard_updates_sched_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_guard_updates_sched_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_guard_updates_sched_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_bun_entries_guard_updates",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "entry"
                    },
                    {
                      "context": "entry",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "task",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ext_guard_updates",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ExtractPatientGuardianUpdatesTask",
                          "variable": [
                            "src",
                            "carePlan",
                            "task"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_guard_updates_out_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activity",
                          "contextType": "variable",
                          "element": "outcomeReference",
                          "variable": "activityOutcomeRef",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Reference"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_act_guard_updates_out_ref_ref",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "reference",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "'Task/' + $this.id"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_act_guard_updates_out_ref_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "$this.description"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractPatientGuardianUpdatesTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_guard_updates_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Guardian Updates"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "r_guard_updates_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_guard_updates_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_guard_updates_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_guard_updates_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "taskExecutionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_guard_updates_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_guard_updates_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_guard_updates_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_guard_updates_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_guard_updates_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_guard_updates_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_guard_updates_task_age_in_years_calc",
              "source": [
                {
                  "context": "src",
                  "element": "birthDate",
                  "variable": "birthDate"
                }
              ],
              "target": [
                {
                  "variable": "date_after_15_years",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "birthDate"
                    },
                    {
                      "valueString": "($this + ((15 * 365).toString() + ' days').toQuantity())"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_guard_updates_task_reason_ref_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "taskReasonRef",
                      "contextType": "variable",
                      "element": "reference",
                      "transform": "evaluate",
                      "parameter": [
                        {
                          "valueId": "date_after_15_years"
                        },
                        {
                          "valueString": "iif($this >= today(), 'Questionnaire/patient-guardian-updates-0-to-15-years', 'Questionnaire/patient-guardian-updates-15-years-plus')"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_guard_updates_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Guardian Updates"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_guard_updates_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_guard_updates_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_guard_updates_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_guard_updates_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_guard_updates_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_guard_updates_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddPatientTBCovidActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_tb_covid_act_det",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_covid_act_det",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_tb_covid_act_det_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "TB/COVID Screening"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_covid_act_det_code",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_covid_act_det_cc_cod",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "client-tb-covid-screening"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_ndc_tb_covid_act_det_cod_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "TB/COVID Screening"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_covid_act_det_cc_txt",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "TB/COVID Screening"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_covid_act_det_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "activityDetailPerformer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_covid_act_det_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_covid_act_det_author_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityDetailPerformer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_covid_act_det_sch_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_covid_act_det_sch_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_covid_act_sch_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_covid_bun_entries",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "entry"
                },
                {
                  "context": "entry",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "task",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Task"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_ndc_tb_covid_ext_task",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtractPatientTBCovidTask",
                      "variable": [
                        "src",
                        "carePlan",
                        "task"
                      ]
                    }
                  ]
                },
                {
                  "name": "r_ndc_tb_covid_act_out_ref",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "activity",
                      "contextType": "variable",
                      "element": "outcomeReference",
                      "variable": "activityOutcomeRef",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ndc_tb_covid_act_out_ref_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "'Task/' + $this.id"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_ndc_tb_covid_act_out_ref_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activityOutcomeRef",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "task"
                            },
                            {
                              "valueString": "$this.description"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractPatientTBCovidTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_ndc_tb_covid_task_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "TB/COVID Screening"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "variable": "current_date_time",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "current_date_time"
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_covid_task_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_covid_task_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_ndc_tb_covid_task_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_covid_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "executionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_covid_task_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_covid_task_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "executionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_covid_task_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_covid_task_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_covid_task_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_covid_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_covid_task_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/patient-tb-covid"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_covid_task_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "TB/COVID Screening"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_covid_task_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_covid_task_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_covid_task_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_tb_covid_task_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_ndc_tb_covid_task_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_tb_covid_task_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "AddPatientDemographicUpdatesActivity",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "carePlan",
          "type": "CarePlan",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_c_p_act_demo_updates",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "carePlan",
              "contextType": "variable",
              "element": "activity",
              "variable": "activity",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "CarePlan_Activity"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_c_p_act_det_demo_updates",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "activity",
                  "contextType": "variable",
                  "element": "detail",
                  "variable": "detail",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "CarePlan_ActivityDetail"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "r_act_det_demo_updates_data",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "kind",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "status",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "in-progress"
                        }
                      ]
                    },
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "description",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Demographic Updates"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_det_code_demo_updates",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "code",
                      "variable": "concept",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "CodeableConcept"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_cp_cc_cod_demo_updates",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "coding",
                          "variable": "coding",
                          "transform": "c",
                          "parameter": [
                            {
                              "valueString": "https://d-tree.org"
                            },
                            {
                              "valueString": "patient-demographic-updates"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_cp_cod_disp_demo_updates",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "coding",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "copy",
                              "parameter": [
                                {
                                  "valueString": "Demographic Updates"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_cp_cc_txt_demo_updates",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "concept",
                          "contextType": "variable",
                          "element": "text",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Demographic Updates"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_demo_updates_perf",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "performer",
                      "variable": "performer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_demo_updates_perf_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "reference",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_demo_updates_perf_disp",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "performer",
                          "contextType": "variable",
                          "element": "display",
                          "transform": "copy",
                          "parameter": [
                            {
                              "valueString": "Test CHW"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_act_demo_updates_sched_period",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "detail",
                      "contextType": "variable",
                      "element": "scheduled",
                      "variable": "scheduledPeriod",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Period"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_act_demo_updates_sched_period_start",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "start",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now()"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_demo_updates_sched_period_end",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "scheduledPeriod",
                          "contextType": "variable",
                          "element": "end",
                          "transform": "evaluate",
                          "parameter": [
                            {
                              "valueId": "src"
                            },
                            {
                              "valueString": "now() + ('14 days').toQuantity()"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "r_bun_entries_demo_updates",
                  "source": [
                    {
                      "context": "src"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "entry"
                    },
                    {
                      "context": "entry",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "task",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Task"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "r_ext_demo_updates",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ExtractPatientDemographicUpdatesTask",
                          "variable": [
                            "src",
                            "carePlan",
                            "task"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "r_act_demo_updates_out_ref",
                      "source": [
                        {
                          "context": "src"
                        }
                      ],
                      "target": [
                        {
                          "context": "activity",
                          "contextType": "variable",
                          "element": "outcomeReference",
                          "variable": "activityOutcomeRef",
                          "transform": "create",
                          "parameter": [
                            {
                              "valueString": "Reference"
                            }
                          ]
                        }
                      ],
                      "rule": [
                        {
                          "name": "r_act_demo_updates_out_ref_ref",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "reference",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "'Task/' + $this.id"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "r_act_demo_updates_out_ref_disp",
                          "source": [
                            {
                              "context": "src"
                            }
                          ],
                          "target": [
                            {
                              "context": "activityOutcomeRef",
                              "contextType": "variable",
                              "element": "display",
                              "transform": "evaluate",
                              "parameter": [
                                {
                                  "valueId": "task"
                                },
                                {
                                  "valueString": "$this.description"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtractPatientDemographicUpdatesTask",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "Patient",
          "mode": "source"
        },
        {
          "name": "careplan",
          "type": "CarePlan",
          "mode": "source"
        },
        {
          "name": "task",
          "type": "Task",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "r_demo_updates_data",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ready"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "plan"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "priority",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "routine"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "description",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Demographic Updates"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            },
            {
              "context": "task",
              "contextType": "variable",
              "element": "lastModified",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueId": "src"
                },
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "r_demo_updates_id",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "identifier",
              "variable": "taskIdentifier",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_demo_updates_id_value",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "value",
                  "transform": "uuid"
                }
              ]
            },
            {
              "name": "r_demo_updates_id_use",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskIdentifier",
                  "contextType": "variable",
                  "element": "use",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "official"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_demo_updates_exec_period",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "executionPeriod",
              "variable": "taskExecutionPeriod",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Period"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_demo_updates_exec_period_start",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "start",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.start"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_demo_updates_exec_period_end",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskExecutionPeriod",
                  "contextType": "variable",
                  "element": "end",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "careplan"
                    },
                    {
                      "valueString": "$this.period.end"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_demo_updates_for",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "for",
              "variable": "taskFor",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_demo_updates_for_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "'Patient/' + $this.id"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_demo_updates_for_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskFor",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueId": "src"
                    },
                    {
                      "valueString": "$this.name.given + ' ' + $this.name.family"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_ndc_demo_updates_task_reason_ref",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "reasonReference",
              "variable": "taskReasonRef",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_demo_updates_task_reason_ref_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Questionnaire/patient-demographic-updates"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_ndc_demo_updates_reason_ref_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskReasonRef",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Demographic Updates"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_demo_updates_reqstr",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "requester",
              "variable": "taskRequester",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_demo_updates_reqstr_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_demo_updates_reqstr_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskRequester",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "r_demo_updates_owner",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "task",
              "contextType": "variable",
              "element": "owner",
              "variable": "taskOwner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "r_demo_updates_owner_ref",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner/649b723c-28f3-4f5f-8fcf-28405b57a1ec"
                    }
                  ]
                }
              ]
            },
            {
              "name": "r_demo_updates_owner_disp",
              "source": [
                {
                  "context": "src"
                }
              ],
              "target": [
                {
                  "context": "taskOwner",
                  "contextType": "variable",
                  "element": "display",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Test CHW"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}