{
    "resourceType": "PlanDefinition",
    "id": "5593",
    "contained": [
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-init-activity",
        "title": "ANC Register Handler Activity",
        "status": "active",
        "description": "This action will assess careplan on registration to init careplan",
        "kind": "CarePlan",
        "dynamicValue": [
          {
            "path": "title",
            "expression": {
              "language": "text/fhirpath",
              "expression": "%rootResource.title"
            }
          },
          {
            "path": "description",
            "expression": {
              "language": "text/fhirpath",
              "expression": "%rootResource.description"
            }
          },
          {
            "path": "instantiatesCanonical",
            "expression": {
              "language": "text/fhirpath",
              "expression": "%rootResource.id.replaceMatches('/_history/.*', '')"
            }
          },
          {
            "path": "status",
            "expression": {
              "language": "text/fhirpath",
              "expression": "'active'"
            }
          },
          {
            "path": "intent",
            "expression": {
              "language": "text/fhirpath",
              "expression": "'plan'"
            }
          },
          {
            "path": "created",
            "expression": {
              "language": "text/fhirpath",
              "expression": "now()"
            }
          },
          {
            "path": "subject",
            "expression": {
              "language": "text/fhirpath",
              "expression": "%resource.entry.where(resource is QuestionnaireResponse).resource.subject"
            }
          },
          {
            "path": "author",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this.generalPractitioner.first()"
            }
          },
          {
            "path": "period.start",
            "expression": {
              "language": "text/fhirpath",
              "expression": "%resource.entry.where(resource is QuestionnaireResponse).resource.descendants().where(linkId='245679f2-6172-456e-8ff3-425f5cea3243').answer.value"
            }
          },
          {
            "path": "period.end",
            "expression": {
              "language": "text/fhirpath",
              "expression": "%resource.entry.where(resource is QuestionnaireResponse).resource.descendants().where(linkId='245679f2-6172-456e-8ff3-425f5cea3243').answer.value + 9 'months'"
            }
          },
          {
            "path": "activity.detail.kind",
            "expression": {
              "language": "text/fhirpath",
              "expression": "'Task'"
            }
          },
          {
            "path": "activity.detail.status",
            "expression": {
              "language": "text/fhirpath",
              "expression": "'in-progress'"
            }
          },
          {
            "path": "activity.detail.description",
            "expression": {
              "language": "text/fhirpath",
              "expression": "'This action will assess careplan on registration to init careplan'"
            }
          },
          {
            "path": "activity.detail.performer",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this.generalPractitioner.first()"
            }
          }
        ]
      },
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-task-activity-1st",
        "title": "1st ANC Follow Up",
        "description": "This action will performed till 12th week for a pregnant woman",
        "status": "active",
        "kind": "Task",
        "timingTiming": {
          "repeat": {
            "count": 1,
            "duration": 12,
            "durationUnit": "wk",
            "period": 0,
            "periodUnit": "wk"
          }
        }
      },
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-task-activity-2nd",
        "title": "2nd ANC Follow Up",
        "description": "This action will perform from 13th to 26th week for a pregnant woman",
        "status": "active",
        "kind": "Task",
        "timingTiming": {
          "repeat": {
            "count": 1,
            "duration": 14,
            "durationUnit": "wk",
            "period": 13,
            "periodUnit": "wk"
          }
        }
      },
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-task-activity-3rd",
        "title": "3rd ANC Follow Up",
        "description": "This action will perform from 27th to 34th week for a pregnant woman",
        "status": "active",
        "kind": "Task",
        "timingTiming": {
          "repeat": {
            "count": 1,
            "duration": 8,
            "durationUnit": "wk",
            "period": 27,
            "periodUnit": "wk"
          }
        }
      },
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-task-activity-4th",
        "title": "4th ANC Follow Up",
        "description": "This action will perform from 35th to 38th week for a pregnant woman",
        "status": "active",
        "kind": "Task",
        "timingTiming": {
          "repeat": {
            "count": 1,
            "duration": 4,
            "durationUnit": "wk",
            "period": 35,
            "periodUnit": "wk"
          }
        }
      },
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-followup-activity",
        "title": "ANC Follow Up Handler Activity",
        "status": "active",
        "description": "This action will assess careplan every time a followup happens on a task generated by plan",
        "kind": "CarePlan",
        "dynamicValue": [
          {
            "path": "CarePlan.status",
            "expression": {
              "language": "text/fhirpath",
              "expression": "'completed'"
            }
          }
        ]
      }
    ],
    "name": "ANC Follow Up Plan",
    "title": "ANC Follow Up Plan",
    "status": "active",
    "description": "This defines the schedule of care for pregnant women",
    "goal": [
      {
        "category": {
          "coding": [
            {
              "system": "https://www.hl7.org/fhir/codesystem-goal-category.html",
              "code": "nursing",
              "display": "Nursing"
            }
          ]
        },
        "priority": {
          "coding": [
            {
              "system": "https://www.hl7.org/fhir/codesystem-goal-priority.html",
              "code": "high-priority",
              "display": "High Priority"
            }
          ]
        },
        "start": {
          "coding": [
            {
              "system": "http://www.snomed.org/",
              "code": "32485007",
              "display": "Admission to hospital"
            }
          ]
        }
      }
    ],
    "action": [
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.where(questionnaire = 'Questionnaire/5589').exists()"
            }
          }
        ],
        "definitionCanonical": "#careplan-init-activity"
      },
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.where(questionnaire = 'Questionnaire/5589').exists() and %resource.entry.where(resource is QuestionnaireResponse).resource.descendants().where(linkId='245679f2-6172-456e-8ff3-425f5cea3243').answer.value >= today() - 12 'weeks'"
            }
          }
        ],
        "participant": [
          {
            "type": "practitioner",
            "role": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/practitioner-role",
                  "code": "nurse",
                  "display": "Nurse"
                }
              ]
            }
          }
        ],
        "type": {
          "coding": [
            {
              "code": "clinical-protocol",
              "display": "Clinical Protocol"
            }
          ]
        },
        "definitionCanonical": "#careplan-task-activity-1st",
        "transform": "http://fhir.mpower-social.com:7070/fhir/StructureMap/5592"
      },
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.where(questionnaire = 'Questionnaire/5589').exists() and %resource.entry.where(resource is QuestionnaireResponse).resource.descendants().where(linkId='245679f2-6172-456e-8ff3-425f5cea3243').answer.value >= today() - 26 'weeks'"
            }
          }
        ],
        "participant": [
          {
            "type": "practitioner",
            "role": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/practitioner-role",
                  "code": "nurse",
                  "display": "Nurse"
                }
              ]
            }
          }
        ],
        "type": {
          "coding": [
            {
              "code": "clinical-protocol",
              "display": "Clinical Protocol"
            }
          ]
        },
        "definitionCanonical": "#careplan-task-activity-2nd",
        "transform": "http://fhir.mpower-social.com:7070/fhir/StructureMap/5592"
      },
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.where(questionnaire = 'Questionnaire/5589').exists() and %resource.entry.where(resource is QuestionnaireResponse).resource.descendants().where(linkId='245679f2-6172-456e-8ff3-425f5cea3243').answer.value >= today() - 34 'weeks'"
            }
          }
        ],
        "participant": [
          {
            "type": "practitioner",
            "role": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/practitioner-role",
                  "code": "nurse",
                  "display": "Nurse"
                }
              ]
            }
          }
        ],
        "type": {
          "coding": [
            {
              "code": "clinical-protocol",
              "display": "Clinical Protocol"
            }
          ]
        },
        "definitionCanonical": "#careplan-task-activity-3rd",
        "transform": "http://fhir.mpower-social.com:7070/fhir/StructureMap/5592"
      },
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.where(questionnaire = 'Questionnaire/5589').exists() and %resource.entry.where(resource is QuestionnaireResponse).resource.descendants().where(linkId='245679f2-6172-456e-8ff3-425f5cea3243').answer.value >= today() - 38 'weeks'"
            }
          }
        ],
        "participant": [
          {
            "type": "practitioner",
            "role": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/practitioner-role",
                  "code": "nurse",
                  "display": "Nurse"
                }
              ]
            }
          }
        ],
        "type": {
          "coding": [
            {
              "code": "clinical-protocol",
              "display": "Clinical Protocol"
            }
          ]
        },
        "definitionCanonical": "#careplan-task-activity-4th",
        "transform": "http://fhir.mpower-social.com:7070/fhir/StructureMap/5592"
      },
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.questionnaire = 'Questionnaire/345'"
            }
          }
        ],
        "definitionCanonical": "#careplan-followup-activity"
      }
    ]
  }