"use strict";(self.webpackChunkfhircore=self.webpackChunkfhircore||[]).push([[7869],{7791:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var r=i(4848),t=i(8453);const a={sidebar_label:"App flavors"},s="How to Add/Modify App Flavors",o={id:"engineering/app/configuring/add-application-flavors",title:"How to Add/Modify App Flavors",description:"Product Flavors Configuration",source:"@site/docs/engineering/app/configuring/add-application-flavors.mdx",sourceDirName:"engineering/app/configuring",slug:"/engineering/app/configuring/add-application-flavors",permalink:"/engineering/app/configuring/add-application-flavors",draft:!1,unlisted:!1,editUrl:"https://github.com/opensrp/fhircore/tree/main/docs/engineering/app/configuring/add-application-flavors.mdx",tags:[],version:"current",frontMatter:{sidebar_label:"App flavors"},sidebar:"defaultSidebar",previous:{title:"Configurations",permalink:"/engineering/app/configuring/"},next:{title:"Implementation Guide",permalink:"/engineering/app/configuring/config-types/ImplementationGuide"}},d={},l=[{value:"Product Flavors Configuration",id:"product-flavors-configuration",level:2},{value:"Configuration Details",id:"configuration-details",level:2},{value:"<code>flavorDimensions</code> Declaration",id:"flavordimensions-declaration",level:3},{value:"<code>productFlavors</code> Configuration",id:"productflavors-configuration",level:3},{value:"Config properties of productFlavors",id:"config-properties-of-productflavors",level:3},{value:"Android Application Variants Configuration",id:"android-application-variants-configuration",level:3}];function c(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"how-to-addmodify-app-flavors",children:"How to Add/Modify App Flavors"})}),"\n",(0,r.jsx)(n.h2,{id:"product-flavors-configuration",children:"Product Flavors Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Product flavors are a way to create different versions of the same application with distinct features or characteristics. Each product flavor represents a different version of the application, and you can configure various aspect of the app for each flavor. To set this up, navigate to ",(0,r.jsx)(n.code,{children:"fhircore > android > quest > Gradle scripts > build.gradle.kts"})," in the ",(0,r.jsx)(n.code,{children:"quest"})," module."]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-details",children:"Configuration Details"}),"\n",(0,r.jsxs)(n.h3,{id:"flavordimensions-declaration",children:[(0,r.jsx)(n.code,{children:"flavorDimensions"})," Declaration"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"flavorDimensions"}),' variable is used to declare dimensions for product flavors. In the provided code snippet, a new dimension named "apps" is added to the existing flavor dimensions.']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'flavorDimensions += "apps"\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"productflavors-configuration",children:[(0,r.jsx)(n.code,{children:"productFlavors"})," Configuration"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"productFlavors"})," block is used to define different flavors of the Android application."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'productFlavors {\n    create("opensrp") {\n        dimension = "apps"\n        manifestPlaceholders["appLabel"] = "OpenSRP"\n        isDefault = true\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"The product flavors are easily modified to the specified app flavor e.g."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'create("afyaYangu") {\n      dimension = "apps"\n      applicationIdSuffix = ".afyaYangu"\n      versionNameSuffix = "-afyaYangu"\n      manifestPlaceholders["appLabel"] = "Afya Yangu"\n    }\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["Remember to use ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Camel_case",children:"camelCase"})})," when adding the ",(0,r.jsx)(n.strong,{children:"flavor name"})," e.g ",(0,r.jsx)(n.code,{children:"newFlavor"}),", ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"applicationIdSuffix"})})," e.g ",(0,r.jsx)(n.code,{children:".newFlavor"})," and ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"versionNameSuffix"})})," e.g ",(0,r.jsx)(n.code,{children:"-newFlavor"})]})}),"\n",(0,r.jsx)(n.h3,{id:"config-properties-of-productflavors",children:"Config properties of productFlavors"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Required"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Default"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"create ()"}),(0,r.jsx)(n.td,{children:"Block defining the product flavor"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"yes"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"dimension"}),(0,r.jsxs)(n.td,{children:["Specifies that the ",(0,r.jsx)(n.code,{children:"app"}),' flavor belongs to the "apps" dimension']}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"yes"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"apps"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'manifestPlaceholders["appLabel"]'}),(0,r.jsxs)(n.td,{children:["Sets a placeholder in the ",(0,r.jsx)(n.code,{children:"build.gradle.kts"}),' file. This is often used to customize values in the manifest based on the flavor. In this case, the appLabel placeholder is set to "app flavor."']}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"yes"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"isDefault"}),(0,r.jsx)(n.td,{children:': Marks the "opensrp" flavor as the default flavor. This means that if no flavor is specified during the build, the "opensrp" flavor will be used by default.'}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{style:{textAlign:"center"}})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"applicationIdSuffix"}),(0,r.jsx)(n.td,{children:"Used to append a suffix to the applicationId for a specific product flavor or build type. This is particularly useful when you want to create multiple variants of your app with slight variations, such as different flavors for testing, preview, or other environments."}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{style:{textAlign:"center"}})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"android-application-variants-configuration",children:"Android Application Variants Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Integrate this code snippet into your Android Gradle build file and plce it within the ",(0,r.jsx)(n.code,{children:"android"})," block."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'android {\n    // ... other configuration ...\n\n    applicationVariants.all {\n        val variant = this\n        variant.resValue("string", "authenticator_account_type", "\\"${applicationId}\\"")\n        variant.resValue(\n          "string",\n          "app_name",\n          "\\"${variant.mergedFlavor.manifestPlaceholders["appLabel"]}\\"",\n        )\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["The provided code snippet operates within the context of ",(0,r.jsx)(n.code,{children:"applicationVariants.all"}),", iterating over all application variants. It customizes two string resources: ",(0,r.jsx)(n.code,{children:"authenticator_account_type"})," and ",(0,r.jsx)(n.code,{children:"app_name"}),".",(0,r.jsx)(n.code,{children:'variant.resValue("string", "authenticator_account_type", "\\"${applicationId}\\"")'}),"\nThis line sets the ",(0,r.jsx)(n.code,{children:"authenticator_account_type"})," string resource dynamically for each variant. Here's a breakdown:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"variant"}),": Represents the current application variant in the iteration."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'resValue("string", "authenticator_account_type", "\\"${applicationId}\\"")'}),': Defines a string resource with the name "authenticator_account_type" and assigns its value as the applicationId of the current variant. The',(0,r.jsx)(n.code,{children:'\\"${applicationId}\\"'}),"syntax ensures that the ",(0,r.jsx)(n.code,{children:"applicationId"})," is enclosed in double quotes."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:'variant.resValue("string", "app_name", "\\"${variant.mergedFlavor.manifestPlaceholders["appLabel"]}\\"")'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["This line sets the ",(0,r.jsx)(n.code,{children:"app_name"})," string resource dynamically for each variant. Here's a breakdown:"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'resValue("string", "app_name", "\\"${variant.mergedFlavor.manifestPlaceholders["appLabel"]}\\"")'}),": Defines a string resource with the name ",(0,r.jsx)(n.code,{children:"app_name"})," and assigns its value as the ",(0,r.jsx)(n.code,{children:"appLabel"})," specified in the manifest placeholders of the current variant. The ",(0,r.jsx)(n.code,{children:'\\"${variant.mergedFlavor.manifestPlaceholders["appLabel"]}\\"'})," syntax ensures that the ",(0,r.jsx)(n.code,{children:"appLabel"})," is enclosed in double quotes."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," This code block is placed within the Gradle file to avoid conflicts with other configurations."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["One can also define the type of build variant one needs to work with eg: ",(0,r.jsx)(n.code,{children:"debugNonProxy"}),",",(0,r.jsx)(n.code,{children:"debug"}),", ",(0,r.jsx)(n.code,{children:"release"}),", etc. Integrate the below code snippet to the ",(0,r.jsx)(n.code,{children:"android"})," block in the Gradle file."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'android {\n    // ... other configuration ...\n\n    buildTypes {\n        create("debugNonProxy") { initWith(getByName("debug")) }\n\n        getByName("release") {\n            isMinifyEnabled = false\n            proguardFiles(getDefaultProguardFile("proguard-android-optimize.txt"), "proguard-rules.pro")\n            signingConfig = signingConfigs.getByName("release")\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:'create("debugNonProxy") { initWith(getByName("debug")) }'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'This line creates a new custom build variant named "debugNonProxy" by inheriting configurations from the existing "debug" variant. Here\'s a breakdown:'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'create("debugNonProxy")'}),': Defines a new build variant with the name "debugNonProxy".']}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'{ initWith(getByName("debug")) }'}),': Initializes the "debugNonProxy" variant by inheriting configurations from the "debug" variant. This allows "debugNonProxy" to share properties and settings with "debug" while still providing the flexibility to customize its behavior.']}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:'getByName("release") { ... }'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'This block customizes the "release" build variant by modifying certain configurations:'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"isMinifyEnabled = false"}),": Disables code shrinking and obfuscation by setting minification to false."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'proguardFiles(getDefaultProguardFile("proguard-android-optimize.txt"), "proguard-rules.pro")'}),': Specifies ProGuard rules files for the "release" variant. ProGuard is a code shrinker and obfuscator for Java projects.']}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'signingConfig = signingConfigs.getByName("release")'}),': Associates the signing configuration named "release" with the "release" variant. This ensures that the "release" variant is signed with the specified signing configuration']}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>o});var r=i(6540);const t={},a=r.createContext(t);function s(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);